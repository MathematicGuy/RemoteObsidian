**2. Dự án: "Phân loại Hành vi Bất thường Đơn giản trong Môi Trường Trường Học Sử Dụng Mô hình Học Sâu"**

- **Mô tả:** Phát triển một hệ thống phân loại các hành vi bất thường đơn giản (ví dụ: chạy quá nhanh, leo trèo, tụ tập) trong video giám sát.
    
- **Dataset:**
    
    - **UCF-Crime:** Mặc dù dataset này chủ yếu về các hành vi tội phạm, một số hành vi (ví dụ: chạy, xô đẩy) có thể tương tự với hành vi bất thường trong trường học. Bạn có thể chọn lọc các video phù hợp.
        
    - **Real Life Violence Situations Dataset:** Dataset này có các video về hành vi bạo lực nhưng cũng có các hành vi khác như xô đẩy, tụ tập mà có thể sử dụng cho bài toán này.
        
    - **Tự thu thập:** Bạn có thể tự thu thập các video về các hành vi này từ YouTube hoặc các nguồn khác.
        
- **Cơ chế hoạt động:**
    
    - **Trích xuất đặc trưng:** Sử dụng các mô hình CNN để trích xuất đặc trưng từ video.
        
    - **Phân loại hành vi:** Sử dụng các mô hình học sâu (ví dụ: CNN, RNN) để phân loại các hành vi.
        
    - **Đánh giá:** Kiểm tra độ chính xác và khả năng phân loại của mô hình.
        
- **Độ khó:** Trung bình. Yêu cầu kiến thức về deep learning và có kinh nghiệm với các thư viện deep learning như TensorFlow hoặc PyTorch.

---

**Chốt Đề Tài:** Nhận Diện Hành Vi Bất Thường Trong Môi Trường Học Đường Sử Dụng Mô Hình Học Sâu *(Abnormally Behaviour Detection in School Environment using Deep Learning)*

I can detect abnormally behavior like fighting using the same training method for "rushing, climbing, normal, grouping".

**Dataset:** UCF-Crime, Open Source Real Life Violence Situations Dataset. 

[LSTM](https://phamdinhkhanh.github.io/2019/04/22/Ly_thuyet_ve_mang_LSTM.html)
[Human Pose Detection using LSTM](https://nam157.github.io/human_activity_recognition-/)


---

https://notebooklm.google.com/notebook/b65b5554-5f80-47a6-ae6d-58240fb9b3cf

```python
"""
    Input: skeletons = {bodyi {j : (xjoint_j , yjoint_j ), j = [0, 17]}, i = [0, n −1]}
    boxes_object = {boxi (x1, y1, x2, y2 ), i = [0, m −1]}
    n: number of skeletons
    m: number of bounding boxes
    
    Output: boxes_skeleton = {boxi (x1, y1, x2, y2 ), i = [0, n −1]}
    boxes_all = {boxj (x1, y1, x2, y2 ), j = [0, k −1]}
    k: number of persons
"""

for body in skeletons:
    x1 = min(xbody )
    y1 = min(ybody )
    x2 = max(xbody )
    y2 = max(ybody )
    boxes_skeleton.append(x1, y1, x2, y2 )
    boxes_all = boxes_skeleton

    status_skeletons = [True for (i, item) in enumerate(skeletons)]

    for (index_box, box) in enumerate(boxes_object):
        index_max = -1
        number_joints = 0

        for (index_body, body) in enumerate(skeletons):
            if not(status_skeletons[index_body]):
                continue
            if number_joints < count_points(box, body):
                number_joints = count_points(box, body)
                index_max = index_body

    if index_max == -1:
        boxes_append(box)
    else:
        
        status_skeletons[index_max] = False
        boxes_skeleton[index_max] = box
        boxes_all[index_max] = box
return boxes_skeleton, boxes_all
```

---

**Requirements:**
Kế hoạch thực hiện của em và có một chương trình hoặc demo các function em dự kiến thực hiện nhé( bám sát theo chủ đề đề tài NCKH của mình nhé)


 $$N(y_{i}; b) = \frac{y_{i} - b}{(b_{w}, b_{h})}$$ where $y_{i}$ are the coordinate of the n joint (e.g. ankle)

*Solve Pose Estimation as Regression problems*

MSE (Loss)
![[Pasted image 20250115060102.png]]

**Pose Estimation as DNN-based Regressor** to detect and locating position of every single joints. 
![[Pasted image 20250115060225.png]]
-> detect current pose base on joints locations. 

**Cascade of Pose Regressors** -> Learn features of the current pose
All we care about is the location of the joints.  


**Plan**
1. **Dữ liệu đầu vào (Classroom Camera):**
    
    - **Mục đích:** Cung cấp dữ liệu hình ảnh thô cho hệ thống.
        
    - **Phương pháp:** Sử dụng camera để ghi lại video hoặc chuỗi hình ảnh của lớp học.
        
2. **Phát hiện người (Person Detection):**
    
    - **Mục đích:** Xác định vị trí của người trong khung hình, loại bỏ các thông tin không cần thiết từ hậu cảnh.
        
    - **Phương pháp:** Có thể sử dụng các phương pháp như:
        
        - **Faster R-CNN, YOLO, SSD:** Các mô hình object detection dựa trên deep learning.
            
        - **HOG + SVM:** Histogram of Oriented Gradients kết hợp với Support Vector Machine.
            
        - **Background subtraction:** Trừ nền để phát hiện đối tượng chuyển động.
            
3. **Ước lượng dáng điệu (Pose Estimation):**
    
    - **Mục đích:** Xác định vị trí các khớp trên cơ thể người (keypoints) từ hình ảnh hoặc video.
        
    - **Phương pháp:** Các phương pháp phổ biến bao gồm:
        
        - **OpenPose:** Phương pháp dựa trên Part Affinity Fields (PAFs) để kết nối các keypoints.
            
        - **PoseNet, HRNet:** Các mô hình deep learning khác cho ước lượng dáng điệu.
            
4. **Dữ liệu khung xương (Skeleton Data):**
    
    - **Mục đích:** Biểu diễn dáng điệu của người dưới dạng một bộ khung xương được tạo từ các keypoints đã được ước lượng.
        
    - **Phương pháp:** Kết nối các keypoints tương ứng để tạo thành khung xương.
        
5. **Dữ liệu khung xương đã chỉnh sửa (Corrected Skeleton Data):**
    
    - **Mục đích:** Loại bỏ nhiễu, xử lý các keypoints bị thiếu hoặc sai lệch để có được dữ liệu khung xương chính xác hơn.
        
    - **Phương pháp:** Có thể sử dụng các kỹ thuật sau:
        
        - **Temporal smoothing:** Làm mịn dữ liệu theo thời gian.
            
        - **Interpolation:** Nội suy để bổ sung các keypoints bị thiếu.
	    - **Kalman filter:**
		    - **Giảm nhiễu:** Bộ lọc Kalman có thể giúp loại bỏ nhiễu này và tạo ra một đường dẫn mượt mà hơn cho chuyển động của các khớp.
		    - **Dự đoán vị trí của các keypoint bị thiếu dựa trên các keypoint đã được phát hiện trước đó** và mô hình chuyển động. (Giống việc xác định 4 góc từ 3 trong nhận diện thẻ CCCD)
		    - **Dự đoán chuyển động:** Bộ lọc Kalman có thể được sử dụng để dự đoán vị trí của các khớp trong tương lai -> dự đoán hành động, hành vi.
            ![[figure-kalman-filter-algorithm-scalar.png]]
6. **Tiền xử lý dữ liệu khung xương (Pre-processing Skeleton Data):**
    
    - **Mục đích:** Chuẩn bị dữ liệu khung xương cho bước trích xuất đặc trưng.
        
    - **Phương pháp:** Các kỹ thuật tiền xử lý có thể bao gồm:
        
        - **Normalization:** Chuẩn hóa dữ liệu về một khoảng giá trị nhất định.
            
        - **Data augmentation:** Tăng cường dữ liệu bằng cách xoay, lật, phóng to, thu nhỏ,...
            
7. **Trích xuất đặc trưng (Feature Extraction):**
    
    - **Mục đích:** Trích xuất các đặc trưng đại diện cho dáng điệu từ dữ liệu khung xương đã được tiền xử lý.
        
    - **Phương pháp:** Bài báo sử dụng ba loại đặc trưng:
        
        - **Vị trí khớp được chuẩn hóa (Normalized Joint Location):** Chuẩn hóa tọa độ của các keypoints.
            
        - **Khoảng cách giữa các khớp (Joint Distances):** Tính toán khoảng cách Euclidean giữa các cặp keypoints.
            
        - **Góc của xương (Angle of Bones):** Tính toán góc giữa các xương.
            
8. **Mô hình DNN (DNN Model):**
    
    - **Mục đích:** Phân loại hành vi dựa trên các đặc trưng đã được trích xuất.
        
    - **Phương pháp:** Sử dụng mạng nơ-ron sâu (DNN), cụ thể là các lớp fully connected (FC) để học và phân loại hành vi.
        
9. **Phân loại hành vi (Behavior Classification):**
    
    - **Mục đích:** Gán nhãn hành vi cho dữ liệu đầu vào.
        
    - **Phương pháp:** Sử dụng đầu ra của mô hình DNN để dự đoán nhãn hành vi.
        
10. **Kết quả hành vi (Behaviour Result):**
    
    - **Mục đích:** Cung cấp kết quả phân loại hành vi.


